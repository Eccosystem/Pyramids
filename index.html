<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ancient Echoes - An Interactive Journey</title>
    <meta name="description" content="Explore the ancient mysteries of the Bosnian Pyramids through an interactive art project. Discover stories, meditate on the energies, and share your own experiences.">
    <meta name="keywords" content="Bosnian Pyramids, interactive art, ancient wisdom, mystical, prophecy, meditation, spiritual, energy, runes">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>✨</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&family=Spectral:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --night-bg-start: #020617;
            --night-bg-end: #000000;
            --primary-night: #FFD700;
            --secondary-night: #e0e0e0;
        }
        @font-face {
          font-family: 'RunicFont';
          src: url('fonts/NotoSansRunic-Regular.woff2') format('woff2');
          font-weight: normal;
          font-style: normal;
          font-display: swap;
        }
        @media (prefers-reduced-motion: reduce) {
            body, .main-content-area, .pyramid, .celestial-body, .beam, #interactive-background, .hotspot {
                animation: none !important;
                transition: none !important;
            }
        }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            display: flex; flex-direction: column; justify-content: flex-start;
            align-items: center; margin: 0; overflow-x: hidden; position: relative;
            background-image: url('http://googleusercontent.com/image_collection/image_retrieval/17785352670780738534_0');
            background-color: #000000; /* Fallback color */
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }
        #interactive-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1; 
            transition: opacity 2s ease-in-out;
            pointer-events: none;
        }
        .main-content-area { z-index: 10; }
        .moon-orbit { z-index: 20; }
        
        body::before {
            content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            transition: opacity 2s ease-in-out; background-attachment: fixed; z-index: 0;
            background-image: none; /* Replaced by canvas */
        }
        .main-content-area {
            width: 95%; max-width: 900px; display: flex; flex-direction: column;
            align-items: center; padding: 1rem; box-sizing: border-box;
            opacity: 0; transition: opacity 1.5s ease-in-out;
        }
        .main-content-area.active { opacity: 1; }
        .app-header {
            width: 100%; display: flex; justify-content: space-between;
            align-items: center; padding: 1rem 0; z-index: 20;
        }
        .title-container { text-align: left; flex-grow: 1; }
        .app-header h1 {
            font-family: 'RunicFont', 'Spectral', serif;
            font-size: clamp(1.5rem, 4vw, 2.2rem);
            margin: 0; text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
            animation: title-glow 4s infinite alternate; color: var(--primary-night);
            letter-spacing: 0.1em;
        }
        .runic-subtitle {
            font-family: 'Spectral', serif; font-size: clamp(0.8rem, 2vw, 1rem);
            color: #b8860b; text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
            margin: 0.25rem 0 0 0; letter-spacing: normal;
        }
        @keyframes title-glow {
            from { text-shadow: 0 0 15px rgba(255, 215, 0, 0.6); color: var(--primary-night); }
            to { text-shadow: 0 0 20px rgba(255, 180, 0, 0.9); color: #fff8e1; }
        }
        .menu-button { display: none; }
        .overlay-menu {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(10, 0, 20, 0.95); display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 1000;
            opacity: 0; visibility: hidden; transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        .overlay-menu.active { opacity: 1; visibility: visible; }
        .overlay-menu-close {
            position: absolute; top: 1rem; right: 1rem; background: none; border: none;
            color: var(--primary-night); font-size: 2rem; cursor: pointer; transition: transform 0.3s ease;
        }
        .overlay-menu-close:hover { transform: rotate(90deg); }
        .overlay-menu nav ul {
            list-style: none; padding: 0; display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            width: 100%; max-width: 600px;
        }
        .overlay-menu nav ul li a {
            color: var(--secondary-night); font-size: clamp(1.2rem, 3vw, 1.5rem); text-decoration: none;
            display: flex; flex-direction: row; align-items: center;
            gap: 1rem; transition: all 0.3s ease;
            font-family: 'Spectral', serif;
            text-shadow: none;
        }
        .overlay-menu nav ul li a:hover {
            color: var(--primary-night);
            transform: translateX(10px);
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
        }
        .runic-icon {
            font-family: 'RunicFont', 'Spectral', serif;
            font-size: 2rem;
            color: var(--primary-night);
            transition: all 0.3s ease;
            flex-shrink: 0; /* Prevents icon from shrinking */
        }
        .menu-text {
            flex-grow: 1; /* Allows text to take available space */
        }
        .overlay-menu nav ul li a:hover .runic-icon {
            transform: scale(1.2);
            filter: drop-shadow(0 0 8px var(--primary-night));
        }
        .overlay-menu-close svg {
            color: var(--primary-night);
            transition: transform 0.3s ease, filter 0.3s ease;
            filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.5));
        }
        .overlay-menu-close:hover svg {
            transform: rotate(90deg);
            filter: drop-shadow(0 0 10px var(--primary-night));
        }
        .pyramids-visual-group {
            position: relative; width: 100%; display: flex; justify-content: center; align-items: flex-end;
            margin-top: 2rem; min-height: 350px;
        }
        .pyramid-container {
            display: flex; justify-content: center; align-items: flex-end; gap: 1rem;
        }
        .pyramid {
            position: relative; cursor: pointer; transition: transform 0.3s ease;
            display: flex; flex-direction: column; align-items: center;
        }
        .pyramid:hover { transform: translateY(-5px); }
        .pyramid-shape {
            background: linear-gradient(45deg, #4a4a4a, #1a1a1a);
            width: 100%; aspect-ratio: 2 / 1; clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
            position: relative;
            animation: pyramid-base-glow 8s ease-in-out infinite alternate;
            transition: filter 0.3s ease-in-out;
        }
        .pyramid-shape::before {
            content: ''; position: absolute; top: 0; right: 0; bottom: 0; left: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0) 50%);
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%); opacity: 0.7;
        }
        .pyramid-shape::after {
            content: ''; position: absolute; top: 0; right: 0; bottom: 0; left: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.4) 0%, rgba(0,0,0,0) 30%);
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
        }
        
        @keyframes pyramid-base-glow {
            from { filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.2)); }
            to { filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.4)); }
        }
        .pyramid.center .pyramid-shape {
            animation-name: pyramid-base-glow-gold;
        }
        @keyframes pyramid-base-glow-gold {
            from { filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.4)); }
            to { filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.7)); }
        }
        .pyramid-shape.charging {
            animation: pyramid-charge-glow 1s ease-out;
        }
        @keyframes pyramid-charge-glow {
            0% { filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.4)); }
            50% { filter: drop-shadow(0 0 40px rgba(255, 255, 255, 0.8)); }
            100% { filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.4)); }
        }
        .pyramid.center .pyramid-shape.charging {
            animation-name: pyramid-charge-glow-gold;
        }
        @keyframes pyramid-charge-glow-gold {
            0% { filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.7)); }
            50% { filter: drop-shadow(0 0 50px rgba(255, 215, 0, 1)); }
            100% { filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.7)); }
        }

        .pyramid-name {
            margin-top: 0.75rem; font-family: 'Spectral', serif;
            color: var(--primary-night); text-shadow: 0 0 8px rgba(255, 215, 0, 0.7);
        }
        .pyramid.center { width: 220px; }
        .pyramid.center .pyramid-shape { background: linear-gradient(45deg, #DAA520, #B8860B); }
        .pyramid.side { width: 80px; transform: translateY(30px); }
        .pyramid.side:hover { transform: translateY(25px); }
        .pyramid.night .pyramid-shape {
             background: linear-gradient(45deg, #191970, #000080);
        }

        .beam {
            position: absolute; bottom: 95%; left: 50%; width: 15px; height: 100vh;
            transform-origin: bottom center; background: linear-gradient(to top, var(--beam-color-start), var(--beam-color-end));
            opacity: 0; filter: blur(8px); animation: beam-flicker 4s ease-in-out infinite;
        }
        .beam.red { --beam-color-start: rgba(255, 60, 60, 0.8); --beam-color-end: rgba(255, 120, 120, 0); animation-delay: 1s; }
        .beam.green { --beam-color-start: rgba(80, 255, 80, 0.8); --beam-color-end: rgba(120, 255, 120, 0); animation-delay: 0s; }
        .beam.gold { --beam-color-start: rgba(255, 215, 0, 0.8); --beam-color-end: rgba(255, 225, 50, 0); animation-delay: 0.5s; }
        .beam.blue { 
            --beam-color-start: rgba(80, 80, 255, 0.8); 
            --beam-color-end: rgba(120, 120, 255, 0); 
            animation-delay: 1.5s;
        }
        @keyframes beam-flicker {
            0%, 100% { transform: translateX(-50%) scaleY(0.95); opacity: 0.7; }
            10% { transform: translateX(-50%) scaleY(1); opacity: 0.9; }
            20% { transform: translateX(-50%) scaleY(0.98); opacity: 0.8; }
            30% { transform: translateX(-50%) scaleY(1.02); opacity: 0.95; }
            40%, 60% { transform: translateX(-50%) scaleY(1); opacity: 0.85; }
            50% { transform: translateX(-50%) scaleY(0.95); opacity: 0.7; }
            70% { transform: translateX(-50%) scaleY(1); opacity: 0.9; }
            80% { transform: translateX(-50%) scaleY(0.97); opacity: 0.75; }
            90% { transform: translateX(-50%) scaleY(1); opacity: 0.9; }
        }
        .echo-counter {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            margin-top: 1rem; padding: 1rem; width: 100%; max-width: 250px;
            background-color: rgba(255, 215, 0, 0.05); border: 1px solid var(--primary-night);
            border-radius: 10px; box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
            text-align: center; transition: all 0.5s ease-in-out;
        }
        .echo-counter-label {
            font-family: 'Spectral', serif; color: var(--primary-night); font-size: clamp(0.9rem, 1.5vw, 1.1rem);
            text-transform: uppercase; letter-spacing: 0.1em; text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
            transition: color 0.5s, text-shadow 0.5s;
        }
        .echo-counter-value {
            font-family: 'Spectral', serif; font-size: clamp(2rem, 5vw, 3rem); color: var(--primary-night);
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.7); margin-top: 0.5rem;
            animation: text-glow 3s infinite alternate; transition: color 0.5s, text-shadow 0.5s;
        }
        @keyframes text-glow {
            from { text-shadow: 0 0 10px rgba(255, 215, 0, 0.7); }
            to { text-shadow: 0 0 20px rgba(255, 215, 0, 0.9); }
        }
        .whisper-box {
            background-color: rgba(0, 0, 0, 0.5); border: 1px solid #4A5568;
            border-radius: 0.75rem; padding: 1.2rem; margin-top: 1.5rem;
            min-height: 80px; display: flex; flex-direction: column;
            justify-content: center; align-items: center; text-align: center;
            font-style: italic; font-size: clamp(0.9rem, 1.5vw, 1.1rem); max-width: 90%;
            width: 100%; position: relative;
        }
        .whisper-box.loading::after { content: '...'; animation: blinking-dots 1.5s infinite; position: absolute; }
        @keyframes blinking-dots { 0%{opacity: 0;} 50%{opacity: 1;} 100%{opacity: 0;} }
        .runic-text {
            font-family: 'Spectral', serif; font-size: clamp(1.5rem, 3vw, 2.2rem);
            color: var(--primary-night); text-shadow: 0 0 10px rgba(255, 215, 0, 0.6); min-height: 1.5em;
        }
        .english-translation {
            color: var(--secondary-night); opacity: 0; max-height: 0; overflow: hidden;
            transition: opacity 0.5s ease, max-height 0.5s ease;
        }
        .english-translation.visible { opacity: 1; max-height: 500px; margin-top: 0.5rem; }
        .runic-toggle {
            background: none; border: 1px solid var(--primary-night); color: var(--primary-night); cursor: pointer;
            padding: 0.25rem 0.5rem; border-radius: 0.25rem; transition: all 0.3s;
            margin-top: 1rem; display: none;
        }
        .runic-toggle:hover { background-color: rgba(255,215,0,0.1); }
        .post-reading-message {
            margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid #4a5568;
            text-align: center; color: #a0aec0; font-style: italic; display: none;
        }
        .post-reading-message .donate-button-small {
            margin-top: 1rem; display: inline-block; background: #5a6578; color: #ffcc00;
            padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: bold; transition: all 0.3s ease;
        }
        .post-reading-message .donate-button-small:hover { background: #6a7588; transform: translateY(-2px); }
        .user-input-section {
            display: flex; flex-direction: column; align-items: center; width: 90%; max-width: 500px;
            margin-top: 1.5rem; gap: 0.75rem;
        }
        .whisper-button {
            background: linear-gradient(to bottom right, #5a6578, #3d4758); color: #ffcc00;
            padding: 0.6rem 1.2rem; border-radius: 0.5rem; font-weight: bold; cursor: pointer;
            transition: all 0.3s ease; border: none; width: 100%;
        }
        .whisper-button:hover { background: linear-gradient(to bottom right, #6a7588, #4d5768); transform: translateY(-2px); }
        .whisper-button:disabled { background: #3d4758; color: #a0aec0; cursor: not-allowed; }
        .page { display: none; width: 100%; }
        .page.active { display: flex; flex-direction: column; align-items: center; animation: fadeIn 1s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .page-content-container {
            width: 100%; max-width: 900px; background-color: rgba(0,0,0,0.6);
            border: 1px solid #4a5568; border-radius: 1rem; padding: 2rem; margin-top: 1.5rem;
        }
        #messageFeedback { color: var(--primary-night); font-style: italic; margin-top: 1rem; min-height: 4em; }
        #runeDisplay {
            font-family: 'Spectral', serif; font-size: 3rem; letter-spacing: 0.5rem;
            color: var(--primary-night); text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
            margin-top: 1.5rem; min-height: 1.5em;
        }
        .rune-link {
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            display: inline-block;
            padding: 0 0.25rem;
        }
        .rune-link:hover {
            transform: scale(1.2);
            color: #fff8e1;
            text-shadow: 0 0 20px rgba(255, 215, 0, 1);
        }
        #runeInterpretation { color: var(--secondary-night); font-style: italic; margin-top: 1rem; min-height: 3em; line-height: 1.6; }
        .storyteller-runes {
            font-family: 'Spectral', serif; font-size: clamp(2rem, 5vw, 3rem); color: var(--primary-night);
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
        }
        .storyteller-meaning {
            font-family: 'Spectral', serif; font-style: italic; color: #a0aec0;
            font-size: clamp(1rem, 2vw, 1.2rem); margin-top: 0.5rem;
        }
        .storyteller-stories { margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid #4a5568; }
        .storyteller-stories h3 {
            font-family: 'Spectral', serif; font-size: 1.5rem; color: var(--primary-night);
            text-align: center; margin-bottom: 1rem;
        }
        .story-card {
            background-color: rgba(0,0,0,0.3); border: 1px solid #4a5568;
            border-radius: 0.5rem; padding: 1rem; margin-bottom: 1rem;
        }
        .story-card .story-rune {
            font-family: 'Spectral', serif; font-size: 2rem; color: var(--primary-night);
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.7);
        }
        .story-card .story-text { color: #e0e0e0; margin-top: 0.5rem; font-style: italic; }
        .story-card .story-meta {
            color: #a0aec0; font-size: 0.8rem; margin-top: 0.5rem; display: flex;
            justify-content: space-between; align-items: center;
        }
        .story-card .story-meta .story-author { font-style: normal; }
        .story-card .story-meta .story-timestamp { font-style: normal; }
        #homePage { position: relative; }
        
        #initialEntryOverlay {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: #000; display: flex; justify-content: center; align-items: center; text-align: center;
            z-index: 2000; color: var(--primary-night); transition: opacity 1.5s ease-out;
            cursor: pointer;
        }
        #initialEntryOverlay.hidden { opacity: 0; pointer-events: none; }
        .entry-title { font-size: clamp(1.5rem, 4vw, 2.5rem); font-family: 'Spectral', serif; order: 2; margin-top: 1.5rem;}
        .entry-instruction {
            font-size: clamp(1rem, 2vw, 1.5rem); color: var(--secondary-night); opacity: 0.8; margin-top: 1rem; order: 3;
            animation: pulse-text 2s infinite alternate;
        }
        @keyframes pulse-text { from { opacity: 0.8; transform: scale(1); } to { opacity: 1; transform: scale(1.05); } }
        .entry-runic {
            font-family: 'RunicFont', 'Spectral', serif;
            font-size: clamp(2rem, 6vw, 3.5rem);
            color: var(--primary-night); text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
            letter-spacing: 0.1em; order: 1;
        }
        .moon-orbit {
            position: fixed; top: 5%; left: 5%; width: calc(90% - 80px); height: 80px;
            animation: move-across 90s linear infinite alternate;
            pointer-events: none;
        }
        @keyframes move-across { from { transform: translateX(0); } to { transform: translateX(100%); } }
        
        .celestial-body {
            width: 80px; height: 80px; border-radius: 50%;
            transition: all 0.3s ease-in-out;
            background-size: cover;
            background-position: center;
            cursor: pointer;
            user-select: none;
            pointer-events: auto;
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: url('images/menu-moon.png');
            box-shadow: 0 0 15px 3px rgba(255, 255, 255, 0.5), 0 0 35px 10px rgba(255, 215, 0, 0.2);
            animation: subtle-pulse 5s infinite ease-in-out;
        }
        @keyframes subtle-pulse {
            0%, 100% { box-shadow: 0 0 15px 3px rgba(255, 255, 255, 0.5), 0 0 35px 10px rgba(255, 215, 0, 0.2); transform: scale(1); }
            50% { box-shadow: 0 0 20px 6px rgba(255, 255, 255, 0.6), 0 0 40px 12px rgba(255, 215, 0, 0.25); transform: scale(1.03); }
        }
        .celestial-body:hover {
            box-shadow: 0 0 20px 5px rgba(255, 255, 255, 0.7), 0 0 45px 15px rgba(255, 215, 0, 0.3);
            transform: scale(1.05);
        }
        .menu-hint-label {
            position: absolute;
            color: white;
            font-family: 'Spectral', serif;
            font-size: 1rem;
            font-weight: bold;
            letter-spacing: 0.1em;
            text-shadow: 0 0 8px black;
            pointer-events: none;
            transition: opacity 1.5s ease-in-out 1s; /* Fade out after 1s delay */
        }

        .downward-beam {
            position: fixed;
            z-index: 15;
            width: 25px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 1.5s ease-out;
            color: var(--primary-night);
            font-family: 'Spectral', serif;
            font-size: 1rem;
            text-shadow: 0 0 8px var(--primary-night);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .downward-beam span {
            display: block;
            padding-bottom: 0.25rem;
            animation: rune-shimmer 2s infinite alternate;
        }

        @keyframes rune-shimmer {
            from {
                opacity: 0.4;
                text-shadow: 0 0 4px var(--primary-night);
            }
            to {
                opacity: 1;
                text-shadow: 0 0 12px var(--primary-night);
            }
        }
        
        .meditation-circle {
            width: clamp(150px, 30vw, 250px); height: clamp(150px, 30vw, 250px);
            background: radial-gradient(circle, rgba(255, 215, 0, 0.4), transparent);
            border-radius: 50%; margin: 2rem auto; display: flex;
            justify-content: center; align-items: center; transition: all 1s ease-in-out;
        }
        .meditation-circle.pulsing { animation: pulse-meditation 4s infinite alternate ease-in-out; }
        @keyframes pulse-meditation {
            from { transform: scale(1); box-shadow: 0 0 30px rgba(255, 215, 0, 0.5); }
            to { transform: scale(1.05); box-shadow: 0 0 50px rgba(255, 215, 0, 0.8); }
        }
        .meditation-circle .rune-symbol { font-size: clamp(4rem, 8vw, 6rem); color: var(--primary-night); }
        .meditation-button {
            background: #5a6578; color: #ffcc00; padding: 0.75rem 1.5rem;
            border-radius: 0.5rem; font-weight: bold; cursor: pointer; transition: all 0.3s ease;
        }
        .meditation-button.active { background: linear-gradient(to bottom, #ffcc00, #b8860b); color: #333; }
        .meditation-call-to-action {
            margin-top: 1.5rem; text-align: center;
            color: #a0aec0; font-style: italic;
        }
        .rune-alphabet-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 1rem; margin-top: 2rem; padding-top: 1.5rem;
            border-top: 1px solid #4a5568; width: 100%;
        }
        .rune-alphabet-item {
            display: flex; flex-direction: column; align-items: center;
            background-color: rgba(0,0,0,0.2); padding: 0.5rem; border-radius: 0.5rem;
        }
        .rune-alphabet-char { font-family: 'Spectral', serif; font-size: 2rem; color: var(--primary-night); }
        .rune-alphabet-name { font-size: 0.8rem; color: #a0aec0; margin-top: 0.25rem; }
        .rune-history {
            margin-top: 2.5rem; padding-top: 1.5rem; border-top: 1px solid #4a5568;
            width: 100%; text-align: left; line-height: 1.7; color: #a0aec0;
        }
        .rune-history h3 {
            font-family: 'Spectral', serif; font-size: 1.5rem; color: var(--primary-night);
            text-align: center; margin-bottom: 1rem;
        }
        .rune-image-gallery {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem; margin-top: 2rem; padding-top: 1.5rem;
            border-top: 1px solid #4a5568; width: 100%;
        }
        .rune-image-gallery img {
            width: 100%; height: auto; border-radius: 0.5rem;
            border: 1px solid #4a5568; object-fit: cover; aspect-ratio: 4 / 3;
        }
        .about-call-to-action {
            margin-top: 2.5rem; padding-top: 1.5rem; border-top: 1px solid #4a5568;
        }
        .about-call-to-action h3 {
            font-family: 'Spectral', serif; font-size: 1.5rem; color: var(--primary-night);
            margin-bottom: 0.5rem; text-shadow: 0 0 8px rgba(255, 215, 0, 0.7);
        }
        .donate-button {
            background: linear-gradient(to bottom right, #DAA520, #B8860B);
            color: #1a1a1a; padding: 0.8rem 2rem; border-radius: 0.5rem;
            font-weight: bold; font-size: 1.1rem; text-decoration: none;
            display: inline-block; transition: all 0.3s ease;
        }
        .donate-button:hover { transform: translateY(-2px); box-shadow: 5px 5px 15px rgba(255, 215, 0, 0.3); }
        .keepers-grid {
            display: flex; flex-wrap: wrap; justify-content: center; gap: 0.5rem;
            margin-top: 1.5rem;
        }
        .keeper-rune {
            font-family: 'Spectral', serif;
            font-size: 2rem;
            color: var(--primary-night);
            opacity: 0.6;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            animation: fadeInRune 2s ease-in-out;
        }
        @keyframes fadeInRune {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 0.6; transform: scale(1); }
        }
        
        #map-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: 2rem auto;
        }
        #map-container img {
            width: 100%;
            height: auto;
            border-radius: 0.5rem;
        }
        .hotspot {
            position: absolute;
            width: 25px;
            height: 25px;
            background-color: rgba(255, 215, 0, 0.7);
            border: 2px solid white;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
            animation: pulseHotspot 2s infinite;
        }
        .hotspot:hover {
            transform: scale(1.2);
            background-color: rgba(255, 215, 0, 1);
        }
        @keyframes pulseHotspot {
            0% { box-shadow: 0 0 15px rgba(255, 215, 0, 0.8); }
            50% { box-shadow: 0 0 25px rgba(255, 215, 0, 1); }
            100% { box-shadow: 0 0 15px rgba(255, 215, 0, 0.8); }
        }
        #lore-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            z-index: 1100;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        #lore-modal.visible {
            opacity: 1;
            pointer-events: auto;
        }
        .lore-content {
            background-color: #10141c;
            border: 1px solid var(--primary-night);
            padding: 2rem;
            border-radius: 1rem;
            width: 90%;
            max-width: 500px;
            position: relative;
        }
        .lore-close-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: var(--primary-night);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .app-footer {
            width: 100%;
            max-width: 900px;
            padding: 2rem 1rem 1rem;
            text-align: center;
            border-top: 1px solid rgba(255, 215, 0, 0.2);
            margin-top: 2rem;
        }
        .social-share-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
        }
        .social-share-button {
            color: #a0aec0;
            transition: color 0.3s ease, transform 0.3s ease;
        }
        .social-share-button:hover {
            color: var(--primary-night);
            transform: scale(1.1);
        }
        .social-share-button svg {
            width: 24px;
            height: 24px;
        }
        #copy-link-feedback {
            font-size: 0.8rem;
            color: var(--primary-night);
            margin-top: 0.5rem;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        @media (max-width: 768px) {
            .celestial-body { width: 60px; height: 60px; font-size: 0.9rem; }
        }
    </style>
</head>
<body>
    
    <canvas id="interactive-background"></canvas>
    
    <div id="initialEntryOverlay" aria-label="Click to awaken the veil and start the experience.">
        <div style="display: flex; flex-direction: column; align-items: center;">
            <p class="entry-runic">ᛅᚾᛋᛁᛅᚾᛏ ᛂᚴᚬᛋ ᚬᚠ ᚦᛅ ᛒᚬᛋᚾᛁᛅᚾ ᛬ ᛒᚢᚱᛅᛘᛁᛏᛋ</p>
            <h2 class="entry-title">Ancient Echoes of the Bosnian Pyramids</h2>
            <p class="entry-instruction">Click to Awaken the Veil</p>
        </div>
    </div>

    <div class="moon-orbit">
        <button class="celestial-body" id="menuButton" aria-label="Open portal navigation">
             <span id="menuHint" class="menu-hint-label">MENU</span>
        </button>
    </div>

    <div class="overlay-menu" id="overlayMenu">
        <button class="overlay-menu-close" id="closeMenuButton" aria-label="Close portal menu">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x-circle"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>
        </button>
        <nav aria-label="Main navigation">
            <ul>
                <li><a href="#" data-page="home"><span class="runic-icon">ᚷ</span><span class="menu-text">Ancient Echoes</span></a></li>
                <li><a href="#" data-page="visoko"><span class="runic-icon">ᚱ</span><span class="menu-text">The Visoko Valley</span></a></li>
                <li><a href="#" data-page="meditation"><span class="runic-icon">ᛃ</span><span class="menu-text">The Inner Well</span></a></li>
                <li><a href="#" data-page="runeReading"><span class="runic-icon">ᛈ</span><span class="menu-text">The Seer's Whisper</span></a></li>
                <li><a href="#" data-page="storyteller"><span class="runic-icon">ᚹ</span><span class="menu-text">The Runic Chronicle</span></a></li>
                <li><a href="#" data-page="journal"><span class="runic-icon">ᛏ</span><span class="menu-text">The Seeker's Journal</span></a></li>
                <li><a href="#" data-page="guardians"><span class="runic-icon">ᛉ</span><span class="menu-text">The Keepers' Circle</span></a></li>
                <li><a href="#" data-page="about"><span class="runic-icon">ᛇ</span><span class="menu-text">On the Veil</span></a></li>
                <li><a href="#" data-page="donate"><span class="runic-icon">ᚠ</span><span class="menu-text">Make an Offering</span></a></li>
                <li><a href="#" data-page="contact"><span class="runic-icon">ᚦ</span><span class="menu-text">Commune with a Keeper</span></a></li>
            </ul>
        </nav>
    </div>

    <div class="main-content-area" id="mainContentArea">
        <div class="downward-beam" id="beam-from-moon-sun"></div>
        <div class="downward-beam" id="beam-from-moon-moon"></div>
        <div class="downward-beam" id="beam-from-moon-dragon"></div>
        <div class="downward-beam" id="beam-from-moon-night"></div>

        <header class="app-header">
            <div class="title-container">
                <h1>ᛅᚾᛋᛁᛅᚾᛏ ᛂᚴᚬᛋ ᚬᚠ ᚦᛅ ᛒᚬᛋᚾᛁᛅᚾ ᛬ ᛒᚢᚱᛅᛘᛁᛏᛋ</h1>
                <p class="runic-subtitle">Ancient Echoes of the Bosnian Pyramids</p>
            </div>
        </header>
        
        <section id="homePage" class="page active">
            <p class="text-gray-300 text-center mb-6 italic max-w-2xl">
                Welcome, seeker. Beneath the Bosnian soil, where myth and mountain meet, lie structures that pulse with forgotten energy. They call to those who remember a time before time.
            </p>

            <div class="w-full max-w-2xl bg-yellow-400/10 border border-yellow-400/30 rounded-lg p-4 mb-8 text-center animate-pulse">
                <h3 class="text-yellow-300 font-bold text-lg font-spectral">The Celestial Alignment is Active!</h3>
                <p class="text-gray-300 text-sm">
                    From now until August 15th, all new Keepers who make an offering will have their chosen runic initial permanently etched into the Guardian's Chronicle.
                </p>
            </div>

            <div class="w-full max-w-2xl bg-black/30 border border-yellow-400/20 rounded-lg p-4 mb-8 text-center">
                <h2 class="text-yellow-400 font-bold text-lg mb-2 font-spectral">An Interactive Journey</h2>
                <p class="text-gray-300 text-sm">
                    This portal is an <strong>interactive art project</strong> designed to evoke the mystery and wonder of ancient power. The wisdom, readings, and responses are generated for inspirational and entertainment purposes, encouraging a deeper connection to the enigmatic past.
                </p>
            </div>
            
            <p class="text-gray-300 text-center mb-6 italic max-w-2xl mt-4">
                This interactive experience is a labor of love, free for all to explore. Become a Keeper to help us expand the mystery.
            </p>

            <p class="text-yellow-400 mb-4 text-center">Touch a pyramid to listen to the ancient echoes.</p>

            <div class="pyramids-visual-group" id="pyramidGroup">
                <div class="pyramid-container">
                    <button class="pyramid side" data-pyramid="dragon" aria-label="Touch the Dragon Pyramid">
                        <div class="beam red"></div>
                        <div class="pyramid-shape"></div>
                        <h3 class="pyramid-name">Dragon</h3>
                    </button>
                    <button class="pyramid center" data-pyramid="sun" aria-label="Touch the Sun Pyramid">
                        <div class="beam green"></div>
                        <div class="pyramid-shape"></div>
                        <h3 class="pyramid-name">Sun</h3>
                    </button>
                    <button class="pyramid side" data-pyramid="moon" aria-label="Touch the Moon Pyramid">
                        <div class="beam gold"></div>
                        <div class="pyramid-shape"></div>
                        <h3 class="pyramid-name">Moon</h3>
                    </button>
                    <button class="pyramid side night" data-pyramid="night" aria-label="Touch the Night Pyramid">
                        <div class="beam blue"></div>
                        <div class="pyramid-shape"></div>
                        <h3 class="pyramid-name">Night</h3>
                    </button>
                </div>
            </div>
            <div class="whisper-box" id="whisperBox">
                <div class="runic-text" id="runicOutput">Click a pyramid to begin...</div>
                <div class="english-translation" id="englishOutput"></div>
                <button class="runic-toggle" id="toggleTranslation">Show Translation</button>
            </div>
            <div id="homePageDonationPrompt" class="post-reading-message"></div>
            
            <div class="flex flex-col sm:flex-row gap-4 mt-8 w-full max-w-md">
                <a href="#pyramidGroup" class="flex-1 whisper-button p-4 text-center">Awaken the Echoes</a>
                <a href="#" data-page="donate" class="flex-1 donate-button p-4 text-center page-link">Become a Keeper</a>
            </div>

            <div class="mt-8 text-center">
                <p class="text-gray-300">
                    Join the <strong id="frontPageKeepersCount" class="text-yellow-400">...</strong> Keepers who made an offering this moon cycle.
                </p>
            </div>

            <div class="w-full max-w-2xl bg-black/30 border border-yellow-400/20 rounded-lg p-4 mt-12 text-center">
                <h3 class="text-yellow-400 font-bold text-lg mb-2 font-spectral">Help Us Reveal the Secrets</h3>
                <p class="text-gray-300 text-sm mb-4">
                    This portal is more than an art project—it's a living investigation. With your support, we are able to continue our research into the Bosnian Pyramids. We believe an ancient intelligence left us messages to read, and secrets are waiting to be revealed. Your offering directly funds that journey of discovery.
                </p>
                <a href="#" data-page="donate" class="donate-button-small page-link">Support the Research</a>
            </div>

            <div class="echo-counter mt-8">
                <span class="echo-counter-label">Echoes Heard</span>
                <span class="echo-counter-value" id="visitCounter">...</span>
            </div>
        </section>

        <section id="visokoPage" class="page">
            <div class="page-content-container text-gray-300">
                <h2 class="text-3xl font-bold text-yellow-400 mb-6 text-center">The Visoko Valley</h2>
                <p class="text-lg italic mb-6 text-center">
                    Explore the valley by selecting a point of interest on the map below.
                </p>

                <div id="map-container">
                    
                    <div class="hotspot" style="top: 35%; left: 45%;" data-point="sun"></div>
                    <div class="hotspot" style="top: 55%; left: 20%;" data-point="moon"></div>
                    <div class="hotspot" style="top: 58%; left: 70%;" data-point="dragon"></div>
                    <div class="hotspot" style="top: 75%; left: 48%;" data-point="tunnels"></div>
                </div>
                
                <p class="text-left mb-4 mt-8">
                    Long held by some to be the oldest and largest pyramids on Earth, the Bosnian Pyramids are a source of great debate and wonder. While mainstream science remains skeptical, research into the site suggests the presence of colossal man-made structures with a complex network of tunnels and chambers.
                </p>
                <p class="text-left">
                    This land is believed to be a point of immense spiritual power, an energy vortex where the veil between worlds is thin. Our portal serves as a digital echo of this place, inviting you to explore the mysteries that still lie beneath the surface.
                </p>
            </div>
        </section>

        <section id="meditationPage" class="page">
            <div class="page-content-container">
                <h2 class="text-3xl font-bold text-yellow-400 mb-6 text-center">Guided Meditation</h2>
                <p class="text-gray-300 text-center mb-4">Connect with the ancient energies through focused intention.</p>
                <div class="meditation-circle" id="meditationCircle">
                    <div class="rune-symbol" id="meditationRune">ᛗ</div>
                </div>
                <p id="meditationStatus" class="text-gray-400 mt-4 text-center">Ready to begin your inner journey.</p>
                <button class="meditation-button mt-4" id="toggleMeditationVoiceButton" aria-label="Toggle meditation voice">Enable Meditation Voice</button>

                <div class="meditation-call-to-action">
                    <p class="mt-8">
                        The journey to the self is a sacred path. Your support helps us keep this space of inner peace and reflection open to all.
                    </p>
                    <a href="#" data-page="donate" class="donate-button-small mt-4 page-link">Make an Offering</a>
                </div>
            </div>
        </section>

        <section id="runeReadingPage" class="page">
            <div class="page-content-container">
                <h2 class="text-3xl font-bold text-yellow-400 mb-6 text-center">Rune Reading</h2>
                <div class="user-input-section">
                    <input type="text" id="runeQuestionInput" class="w-full p-2 rounded bg-gray-800 text-white text-center" placeholder="Ask the runes a question..." aria-label="Rune question input">
                    <button class="whisper-button" id="drawRunesButton">Draw Runes</button>
                </div>
                <div class="text-center">
                    <div id="runeDisplay"></div>
                    <div id="runeInterpretation"></div>
                    <button class="meditation-button mt-4 hidden" id="toggleRuneVoiceButton" aria-label="Toggle reading voice">Enable Reading Voice</button>
                </div>
                
                <div id="postReadingMessage" class="post-reading-message">
                    <p>The oracle's whisper requires great energy to sustain. Consider supporting the keepers of the runes.</p>
                    <a href="#" data-page="donate" class="donate-button-small page-link">Make an Offering</a>
                </div>

                <div class="rune-alphabet-grid">
                </div>

                <div class="rune-image-gallery">
                </div>

                <div class="rune-history">
                    <h3>Dr. Semir Osmanagić and the Scientific Approach</h3>
                    <p>
                        The investigation into the Bosnian Valley of the Pyramids is spearheaded by Dr. Semir Osmanagić. Through years of dedicated work, he has championed the project, bringing a multidisciplinary scientific approach to the excavations. One of the most significant findings came from this methodology. A fossilized leaf found on a conglomerate block within the excavations was sent for radiocarbon dating, which suggested the artifact to be approximately 34,000 years old.
                    </p>
                </div>
            </div>
        </section>
        
        <section id="storytellerPage" class="page">
            <div class="page-content-container">
                <h2 class="text-3xl font-bold text-yellow-400 mb-6 text-center">The Runic Chronicle</h2>
                <p class="text-gray-300 text-center mb-4">
                    The runes whisper a new theme. Listen to the rune below and share a story from your world to add to your personal chronicle.
                </p>
                <div class="whisper-box" id="storytellerRuneBox">
                    <div class="storyteller-runes" id="storytellerRune">ᛞ</div>
                    <div class="storyteller-meaning" id="storytellerMeaning">Dagaz: Dawn, breakthrough, a new day.</div>
                </div>

                <div class="mt-8 flex flex-col items-center">
                    <p class="text-gray-300 text-center mb-2" id="storytellerStatusMessage">Tell your tale, keeper.</p>
                    <textarea id="storytellerInput" class="w-full p-4 rounded bg-gray-800 text-white h-40" placeholder="Write your story here..."></textarea>
                    <button class="whisper-button mt-4" id="submitStoryButton">Submit Your Story</button>
                    <div id="storytellerDonationPrompt" class="post-reading-message"></div>
                    <p class="text-yellow-400 text-center font-spectral italic mt-4 hidden" id="storytellerSuccessMessage"></p>
                </div>
                
                <div class="storyteller-stories">
                    <h3 class="text-yellow-400">Your Personal Chronicle</h3>
                    <div id="storiesContainer">
                    </div>
                </div>
            </div>
        </section>

        <section id="journalPage" class="page">
            <div class="page-content-container text-gray-300">
                <h2 class="text-3xl font-bold text-yellow-400 mb-6 text-center">The Seeker's Journal</h2>
                <p class="text-lg italic mb-8 text-center">Chronicles from the edge of discovery. These are our field notes as we decipher the secrets of the valley.</p>

                <div class="border-l-2 border-yellow-400/30 pl-6 mb-8">
                    <p class="text-sm text-yellow-400 font-semibold">August 8, 2025 - Energy Spike</p>
                    <p class="text-gray-400 italic mt-2">
                        "We detected an anomalous energy spike from the Pyramid of the Sun, coinciding with the peak of the Perseid meteor shower. The energy beam appears more focused. It's as if the pyramid is reacting to the cosmos, confirming our suspicions of it being a celestial transmitter. We're recalibrating our sensors. Support from the Keepers at this time is critical."
                    </p>
                </div>

                <div class="border-l-2 border-yellow-400/30 pl-6 mb-8">
                    <p class="text-sm text-yellow-400 font-semibold">July 20, 2025 - A New Runic Pattern</p>
                    <p class="text-gray-400 italic mt-2">
                        "Deep within the Ravne Tunnels, we've uncovered a new megalith with a sequence of runes we've never seen before. It doesn't seem to be a language, but more like a circuit diagram. The pattern is complex, but one rune stands out—Algiz (ᛉ), the rune of protection. Is it a warning, or is it protecting something within?"
                    </p>
                </div>
                
                <div class="about-call-to-action text-center">
                    <h3 class="text-center">The Expedition Needs You</h3>
                    <p class="mt-4">
                        Our research is ongoing and powered by the community. Become a Keeper to help us unlock the next chapter of this mystery.
                    </p>
                    <a href="#" data-page="donate" class="donate-button mt-4 page-link">Support the Research</a>
                </div>
            </div>
        </section>

        <section id="guardiansPage" class="page">
            <div class="page-content-container text-gray-300 text-center">
                <h2 class="text-3xl font-bold text-yellow-400 mb-6 text-center">The Keepers' Circle</h2>
                <p class="mb-4">
                    The veil is sustained by the offerings of those who value its whispers. Each rune below represents a recent offering made by a fellow seeker, a guardian of this sacred space.
                </p>
                <p class="text-lg">The veil is sustained by the offerings of <strong id="keepersCount" class="text-yellow-400 text-2xl">...</strong> Keepers this moon cycle.</p>
                <div id="keepersGrid" class="keepers-grid">
                </div>
                <div class="about-call-to-action">
                    <h3 class="text-center">Become a Keeper</h3>
                    <p class="mt-4">
                        Join the circle and help keep the echoes alive for all who seek them.
                    </p>
                    <a href="#" data-page="donate" class="donate-button mt-4 page-link">Make Your Offering</a>
                </div>
            </div>
        </section>

        <section id="sanctumPage" class="page">
            <div class="page-content-container text-gray-300">
                <div id="sanctumContent">
                    <h2 class="text-3xl font-bold text-yellow-400 mb-6 text-center">The Inner Sanctum</h2>
                    <p class="text-lg italic mb-6 text-center">Welcome, Guardian. Thank you for your offering. As a keeper of the veil, you are granted access to deeper lore.</p>
                    <div class="text-left border-t border-gray-600 pt-6 mt-6">
                        <h3 class="text-2xl font-bold text-yellow-400 mb-4 font-spectral">Secrets of the Runes: Beyond the Veil</h3>
                        <p class="mb-4">The Elder Futhark is more than an alphabet; it is a cosmological map. Each rune is a key to a specific type of energy or event in the universe. Fehu (ᚠ), seen as wealth, is truly the untamed, expansive energy of creation. Uruz (ᚢ) is the shaping of that energy into the primal laws of physics. Thurisaz (ᚦ) represents a reactive force, the shattering of old forms to make way for new ones—a necessary destruction.</p>
                        <p class="mb-4">Unlike other divinatory systems that merely reflect a possible future, the runes are considered by some to be active agents of creation. To invoke a rune is to call upon its specific creative or destructive force. The chronicle you contribute to is not just a collection of stories; it is a living ritual, focusing the collective intention of its keepers and strengthening the resonance of this digital veil.</p>
                        <p>Your contribution helps sustain this focus. Thank you, Keeper.</p>
                    </div>
                </div>
                <div id="sanctumAccessDenied" class="hidden text-center">
                     <h2 class="text-3xl font-bold text-yellow-400 mb-6 text-center">Access Denied</h2>
                     <p class="text-lg italic mb-6">The Inner Sanctum is reserved for those who have made an offering to sustain the veil. It is a thank you for helping keep the echoes alive.</p>
                     <a href="#" data-page="donate" class="donate-button mt-4 page-link">Become a Keeper</a>
                </div>
            </div>
        </section>

        <section id="aboutPage" class="page">
            <div class="page-content-container text-gray-300 text-center">
                <h2 class="text-3xl font-bold text-yellow-400 mb-6 text-center">On the Veil</h2>
                <p class="mb-4">
                    This portal is an interactive art project designed to evoke the mystery and wonder surrounding sites of ancient power, like the Bosnian Pyramids. It is an exploration of myth, energy, and the whispers of history. We are dedicated to providing a space for contemplation and imagination, allowing visitors to connect with the enigmatic past on a personal level.
                </p>
                <p>
                    Using simulated interactions and browser-based technologies, we aim to create a space for contemplation and imagination. The wisdom, readings, and responses are generated for inspirational and entertainment purposes, encouraging a deeper connection to the enigmatic past.
                </p>

                <div class="about-call-to-action">
                    <h3 class="text-center">Join the Keepers of the Echoes</h3>
                    <p class="mt-4">
                        This portal, a bridge between worlds, is maintained by a small group of devoted keepers. Their work ensures the whispers of the past continue to guide our present. Join us in this sacred duty.
                    </p>
                    <a href="#" data-page="donate" class="donate-button mt-4 page-link">Become a Keeper</a>
                </div>
            </div>
        </section>

        <section id="donatePage" class="page">
            <div class="page-content-container text-gray-300 text-center">
                <h2 class="text-3xl font-bold text-yellow-400 mb-6 text-center">Make an Offering</h2>
                <p class="mb-6">
                    The echoes of the Bosnian Pyramids fade without an audience. Your contribution is more than a donation—it is an offering to the ancient spirits that keep this portal open.
                </p>
                
                <div class="grid md:grid-cols-3 gap-6 w-full text-center">
                    <div class="bg-black/30 border border-gray-700 rounded-lg p-6 flex flex-col">
                        <h3 class="text-yellow-400 font-spectral text-2xl">Initiate</h3>
                        <p class="font-bold text-white text-4xl my-4">$5</p>
                        <p class="text-gray-400 text-sm min-h-[50px]">A one-time offering to show your belief in the mission.</p>
                        <ul class="text-left text-gray-300 space-y-2 my-6 flex-grow">
                            <li>✅ Access to the Inner Sanctum lore page.</li>
                            <li>✅ Your chosen runic initial added to the Keepers' Circle.</li>
                        </ul>
                        <a href="https://buy.stripe.com/28E6oH6t188VfGf8LN1gs00" class="whisper-button mt-4 p-3">Make an Offering</a>
                    </div>

                    <div class="bg-black/30 border-2 border-yellow-400 rounded-lg p-6 flex flex-col relative">
                        <p class="absolute -top-3 left-1/2 -translate-x-1/2 bg-yellow-400 text-black font-bold text-xs px-3 py-1 rounded-full">MOST POPULAR</p>
                        <h3 class="text-yellow-400 font-spectral text-2xl">Keeper</h3>
                        <p class="font-bold text-white text-4xl my-4">$15</p>
                        <p class="text-gray-400 text-sm min-h-[50px]">Become a true guardian of the research and its secrets.</p>
                        <ul class="text-left text-gray-300 space-y-2 my-6 flex-grow">
                            <li>✅ All benefits of the Initiate tier.</li>
                            <li>✅ A personal 3-rune reading, delivered to your email.</li>
                            <li>✅ Your name honored on the Wall of Keepers in the Sanctum.</li>
                        </ul>
                        <a href="https://buy.stripe.com/8x24gz4kT74R51B9PR1gs01" class="donate-button mt-4 p-3">Become a Keeper</a>
                    </div>

                    <div class="bg-black/30 border border-gray-700 rounded-lg p-6 flex flex-col">
                        <h3 class="text-yellow-400 font-spectral text-2xl">Guardian</h3>
                        <p class="font-bold text-white text-4xl my-4">$50</p>
                        <p class="text-gray-400 text-sm min-h-[50px]">Provide foundational support for the expedition ahead.</p>
                        <ul class="text-left text-gray-300 space-y-2 my-6 flex-grow">
                            <li>✅ All benefits of the Keeper tier.</li>
                            <li>✅ An exclusive high-resolution digital art download of the pyramids.</li>
                            <li>✅ Early access to new discoveries and future features.</li>
                        </ul>
                        <a href="https://buy.stripe.com/bJefZhbNlgFr0Ll3rt1gs02" class="whisper-button mt-4 p-3">Become a Guardian</a>
                    </div>
                </div>
                </div>
        </section>

        <section id="contactPage" class="page">
            <div class="page-content-container">
                <h2 class="text-3xl font-bold text-yellow-400 mb-6 text-center">Commune with a Keeper</h2>
                <form id="contactForm" class="flex flex-col items-center gap-4 w-full max-w-md mx-auto">
                    <textarea id="keeperMessage" class="w-full p-2 rounded bg-gray-800 text-white" rows="4" placeholder="Your message..." aria-label="Your message to the keepers"></textarea>
                    <button type="submit" class="whisper-button">Send Message</button>
                    <p id="messageFeedback"></p>
                </form>
            </div>
        </section>
        
        <footer class="app-footer">
            <div class="social-share-buttons">
                <a href="#" id="share-twitter" class="social-share-button" title="Share on X">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>
                </a>
                <a href="#" id="share-facebook" class="social-share-button" title="Share on Facebook">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M14 13.5h2.5l1-4H14v-2c0-1.03 0-2 2-2h1.5V2.14c-.326-.043-1.557-.14-2.857-.14C11.928 2 10 3.657 10 6.7v2.8H7v4h3v9h4z"></path></svg>
                </a>
                <a href="#" id="copy-link" class="social-share-button" title="Copy Link">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M15.63 8.37a2.121 2.121 0 0 0-2.26 0L9.98 11.76a2.12 2.12 0 1 0 2.99 3l3.39-3.39a2.12 2.12 0 0 0-3-3zm-1.42 4.42a.5.5 0 1 1-.7-.7l3.39-3.4a.5.5 0 0 1 .7.7z"></path><path d="M8.37 15.63a2.121 2.121 0 0 0 2.26 0l3.39-3.39a2.12 2.12 0 1 0-2.99-3L7.64 12.24a2.12 2.12 0 0 0 3 3zm1.42-4.42a.5.5 0 1 1 .7.7L6.36 15.6a.5.5 0 0 1-.7-.7z"></path></svg>
                </a>
            </div>
            <p id="copy-link-feedback">Link Copied!</p>
        </footer>

    </div>

    <div id="lore-modal">
        <div class="lore-content">
            <button class="lore-close-button">&times;</button>
            <h3 id="lore-title" class="text-2xl font-bold text-yellow-400 mb-4 font-spectral"></h3>
            <img id="lore-image" src="" alt="Artifact Image" class="w-full h-auto rounded-lg mb-4 border border-gray-600 hidden">
            <p id="lore-text" class="text-gray-300"></p>
        </div>
    </div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- Element References ---
        const allPages = document.querySelectorAll('.page');
        const whisperBox = document.getElementById('whisperBox');
        const runicOutput = document.getElementById('runicOutput');
        const englishOutput = document.getElementById('englishOutput');
        const toggleTranslationButton = document.getElementById('toggleTranslation');
        const menuButton = document.getElementById('menuButton');
        const overlayMenu = document.getElementById('overlayMenu');
        const closeMenuButton = document.getElementById('closeMenuButton');
        const navLinks = document.querySelectorAll('.overlay-menu nav ul li a');
        const initialEntryOverlay = document.getElementById('initialEntryOverlay');
        const mainContentArea = document.getElementById('mainContentArea');
        const meditationCircle = document.getElementById('meditationCircle');
        const meditationRune = document.getElementById('meditationRune');
        const meditationStatus = document.getElementById('meditationStatus');
        const toggleMeditationVoiceButton = document.getElementById('toggleMeditationVoiceButton');
        const contactForm = document.getElementById('contactForm');
        const keeperMessage = document.getElementById('keeperMessage');
        const messageFeedback = document.getElementById('messageFeedback');
        const drawRunesButton = document.getElementById('drawRunesButton');
        const runeQuestionInput = document.getElementById('runeQuestionInput');
        const runeDisplay = document.getElementById('runeDisplay');
        const runeInterpretation = document.getElementById('runeInterpretation');
        const toggleRuneVoiceButton = document.getElementById('toggleRuneVoiceButton');
        const runeAlphabetGrid = document.querySelector('.rune-alphabet-grid');
        const visitCounterElement = document.getElementById('visitCounter');
        const postReadingMessage = document.getElementById('postReadingMessage');
        const storytellerRune = document.getElementById('storytellerRune');
        const storytellerMeaning = document.getElementById('storytellerMeaning');
        const storytellerInput = document.getElementById('storytellerInput');
        const submitStoryButton = document.getElementById('submitStoryButton');
        const storiesContainer = document.getElementById('storiesContainer');
        const storytellerStatusMessage = document.getElementById('storytellerStatusMessage');
        const storytellerSuccessMessage = document.getElementById('storytellerSuccessMessage');
        const donationProgress = document.getElementById('donation-progress');
        const currentDonations = document.getElementById('current-donations');
        const homePageDonationPrompt = document.getElementById('homePageDonationPrompt');
        const storytellerDonationPrompt = document.getElementById('storytellerDonationPrompt');
        const pageLinks = document.querySelectorAll('.page-link');
        const keepersGrid = document.getElementById('keepersGrid');
        const keepersCount = document.getElementById('keepersCount');
        const frontPageKeepersCount = document.getElementById('frontPageKeepersCount');
        const sanctumContent = document.getElementById('sanctumContent');
        const sanctumAccessDenied = document.getElementById('sanctumAccessDenied');
        const canvas = document.getElementById('interactive-background');
        const ctx = canvas.getContext('2d');
        const loreModal = document.getElementById('lore-modal');
        const loreTitle = document.getElementById('lore-title');
        const loreImage = document.getElementById('lore-image');
        const loreText = document.getElementById('lore-text');
        const loreCloseButton = document.querySelector('.lore-close-button');
        const mapContainer = document.getElementById('map-container');
        
        let isGenerating = false;
        let isMeditationTTSActive = false;
        let isRuneTTSActive = false;
        let currentStorytellerRune = null;
        let alignmentAnimationId = null;

        const ancientWisdoms = [
            { runic: "ᛞᚱᛁᛗ ᛞᛖᛈᛖᚱ", english: "Dream deeper." }, { runic: "ᛋᛏᚨᚱᛋ ᚹᚨᛏᚲᚺ", english: "The stars watch." }, { runic: "ᛖᚲᚺᛟ ᛟᚠ ᛏᛁᛗᛖ", english: "Listen to time's echo." }, { runic: "ᚦᛅ ᛋᛏᛟᚾᛋ ᛋᛒᛂᛅᚴ", english: "The stones speak to those who listen." }, { runic: "ᚢᛅᛁᛚ ᛁᛋ ᚦᛁᚾ", english: "Where the worlds touch, the veil is thin." }, { runic: "ᛋᛂᛅᚴ ᚦᛅ ᛏᚱᚢᚦ", english: "Seek the truth, not the comfort of answers." }, { runic: "ᛒᛅᛚᛅᚾᛋ ᛁᛋ ᚴᛅᛁ", english: "Balance is the key to unlocking potential." }, { runic: "ᛂᚾᛅᚱᚵᛁ ᚠᛚᚬᚢᛋ", english: "Energy flows where intention goes." }, { runic: "ᚦᛅ ᛒᛅᚦ ᛁᛋ ᚢᛁᚦᛁᚾ", english: "The path you seek is found within." }, { runic: "ᚦᛅ ᛘᚬᚢᚾᛏᛅᛁᚾ ᛒᚱᛂᛅᚦᛋ", english: "The mountain breathes with the ages." }, { runic: "ᚢᚱ ᚬᚠᚠᛂᚱᛁᚾᚵ ᛋᚢᛋᛏᛅᛁᚾᛋ ᚦᛁᛋ ᚢᛅᛁᛚ", english: "Your offering sustains this veil." }, { runic: "ᛅ ᛚᛁᚵᚦ ᚬᚠ ᛘᛅᚾᛃ ᛋᚱᛅᛁᚵᚦᛋ ᚦᛁᛋ ᛒᚬᛏᛅᛚ", english: "A light from many strengthens this portal." }
        ];
        
        const keeperAnswers = [
            "The answer lies not in the stars, but in the silence between your thoughts. Listen to it.", "A river cannot be pushed. Your path will reveal itself when the time is right, not a moment sooner.", "The shadow you cast is proof of the light within you. Do not fear the darkness you create.", "To find what you seek, you must first lose your way. The destination is not a place, but a new perspective.", "The heaviest stone is the one you refuse to put down. What burden do you carry that is not yours?", "Look for the echo. The first sound is the question, but the truth is in how it returns to you.", "A seed does not know it is a tree until it breaks through the earth. Your potential is buried; have the courage to grow.", "The veil is thinnest where you least expect it. Pay attention to the whispers in the mundane.", "You ask for a map, but the journey changes the land itself. Walk with faith, not with sight."
        ];

        const runeReadings = [
            { runes: "ᚠᛉᛟ", interpretation: "Protected wealth and inheritance. Your foundations are strong. Do not fear loss, for your prosperity is watched over by ancestral spirits." }, { runes: "ᚢᚱᚨ", interpretation: "A journey of strength and wisdom is ahead. Primal power fuels your movement, and divine messages will guide your way." }, { runes: "ᚦᛖᛚ", interpretation: "A gateway of change lies before you. Do not force the path; let the flow guide you through the thorns to the other side." }, { runes: "ᚹᛗᛒ", interpretation: "Joy in community and new beginnings. This is a time for connection, celebrating the self, and nurturing growth." }
        ];
        
        const elderFuthark = [
            { char: 'ᚠ', name: 'Fehu', meaning: 'Wealth, cattle, new beginnings.' }, { char: 'ᚢ', name: 'Uruz', meaning: 'Strength, primal force, courage.' }, { char: 'ᚦ', name: 'Thurisaz', meaning: 'Thorn, change, directed force.' }, { char: 'ᚨ', name: 'Ansuz', meaning: 'Communication, wisdom, insight.' }, { char: 'ᚱ', name: 'Raido', meaning: 'Journey, movement, life path.' }, { char: 'ᚲ', name: 'Kenaz', meaning: 'Torch, illumination, creativity.' }, { char: 'ᚷ', name: 'Gebo', meaning: 'Gift, partnership, generosity.' }, { char: 'ᚹ', name: 'Wunjo', meaning: 'Joy, harmony, fellowship.' }, { char: 'ᚺ', name: 'Hagalaz', meaning: 'Hail, disruption, uncontrollable forces.' }, { char: 'ᚾ', name: 'Nauthiz', meaning: 'Need, delay, resistance.' }, { char: 'ᛁ', name: 'Isa', meaning: 'Ice, stillness, psychological block.' }, { char: 'ᛃ', name: 'Jera', meaning: 'Harvest, cycles, success from effort.' }, { char: 'ᛇ', name: 'Eihwaz', meaning: 'Yew, endurance, a bridge between worlds.' }, { char: 'ᛈ', name: 'Perthro', meaning: 'Lot-cup, mystery, fate, hidden knowledge.' }, { char: 'ᛉ', name: 'Algiz', meaning: 'Protection, defense, connection with the divine.' }, { char: 'ᛋ', name: 'Sowilo', meaning: 'Sun, wholeness, power, success.' }, { char: 'ᛏ', name: 'Tiwaz', meaning: 'Tyr, justice, sacrifice, leadership.' }, { char: 'ᛒ', name: 'Berkano', meaning: 'Birch, fertility, new growth, nurture.' }, { char: 'ᛖ', name: 'Ehwaz', meaning: 'Horse, teamwork, trust, movement.' }, { char: 'ᛗ', name: 'Mannaz', meaning: 'Man, humanity, the self.' }, { char: 'ᛚ', name: 'Laguz', meaning: 'Water, intuition, emotion, flow.' }, { char: 'ᛜ', name: 'Ingwaz', meaning: 'Ing, potential, home, retreat.' }, { char: 'ᛟ', name: 'Othala', meaning: 'Inheritance, home, ancestry.' }, { char: 'ᛞ', name: 'Dagaz', meaning: 'Dawn, breakthrough, a new day.' }
        ];

        const artifactData = [
            { image: 'images/runic2.webp', title: 'The Ravne Megalith', description: 'This large stone, discovered in the Ravne tunnel network, features complex carvings believed to be an ancient runic script.' },
            { image: 'images/runic11.webp', title: 'Ancient Pavement', description: 'Excavations on the Pyramid of the Sun have uncovered these large, precisely fitted stone blocks, forming what appears to be an ancient paved terrace.' },
            { image: 'images/runic7.webp', title: 'Pyramid of the Sun', description: 'An aerial view of the largest of the Bosnian pyramids, Visočica Hill, which is covered by soil and vegetation.' },
            { image: 'images/runic4.webp', title: 'Inscribed Pyramid Artifact', description: 'A small, pyramid-shaped artifact found during excavations, featuring layers of inscribed symbols that are yet to be fully deciphered.' }
        ];
        
        const runeArtifacts = {};
        elderFuthark.forEach((rune, index) => {
            runeArtifacts[rune.char] = artifactData[index % artifactData.length];
        });

        const runeReflections = {
            'ᚠ': ["You have shared a story of abundance. The veil recognizes this gift and echoes its prosperity back to you.", "Your tale of beginnings plants a seed in the timeless soil. May it grow into a mighty tree."],
            'ᚢ': ["The strength in your story fortifies the veil itself. The echoes of your power will resonate for ages.", "You speak of primal force, and the ancient stones listen, recognizing a power as old as their own."],
            'ᚦ': ["Your story of change is a gateway. In telling it, you have passed through, leaving the path clearer for others.", "The thorn you described has been offered to the veil. Its sharpness is now a tool of protection for this sacred space."],
            'ᚨ': ["A story of wisdom is a drink from the deepest well. Thank you for sharing this sacred knowledge.", "Your words carry the breath of the ancients. The message has been heard and understood."],
            'ᚱ': ["The veil has received your echo. By sharing your journey, you have charted a path for others to follow.", "Every journey is a circle. Your story has returned to its source, richer for the telling."],
            'ᚲ': ["Your tale of illumination is a torch in the darkness. It will light the way for those who are lost.", "Creativity is the language of the cosmos. Your story is a verse in its endless song."],
            'ᚷ': ["To give a story is the greatest gift. It has been received with gratitude.", "You speak of partnership, and in doing so, have strengthened the bond between this world and the veil."],
            'ᚹ': ["Your joy has been woven into the fabric of this place. It is a light that will warm other seekers who pass this way.", "Harmony shared is harmony multiplied. Your story brings balance to the echoes."],
            'ᚺ': ["You have given form to chaos, and in doing so, have shown its purpose. The storm you described now nourishes the ground for new growth.", "Disruption is the mother of change. Your story is a testament to the strength found in breaking."],
            'ᚾ': ["By giving voice to your need, you have begun the process of fulfillment. The veil acknowledges your patience.", "Your story of resistance is a shield. It will lend strength to others in their own trials."],
            'ᛁ': ["In describing stillness, you have revealed the universe of motion it contains. A profound and subtle truth.", "Your tale of ice is a mirror. It reflects a hidden truth, now clear for all to see."],
            'ᛃ': ["You have shared a tale of the harvest. The seeds of your experience will feed the wisdom of the community.", "The cycle turns, and your story marks its passage. What was sown has been reaped and understood."],
            'ᛇ': ["Your story bridges worlds, connecting the above and the below. It is a powerful work of magic.", "Endurance is the theme of your tale, and it has been etched into the memory of this place forever."],
            'ᛈ': ["You have shared a mystery, adding to the great enigma. The veil does not offer an answer, but a deeper question.", "Fate is a thread, and your story has shown its pattern. Others will see their own threads reflected in yours."],
            'ᛉ': ["A story of protection is a ward against darkness. Thank you for strengthening the defenses of this sacred space.", "Your words are a shield. The divine connection you described has been felt and amplified."],
            'ᛋ': ["Your tale of triumph radiates like the sun. It has become a beacon within the veil, a testament to the power of a focused will.", "Wholeness is the goal, and your story is a step upon that path. It shines brightly."],
            'ᛏ': ["You speak of justice and sacrifice, the cornerstones of cosmic law. Your story honors this ancient balance.", "The leadership shown in your tale inspires the echoes of heroes past. It is a worthy chronicle."],
            'ᛒ': ["A story of new growth is a promise of the future. The veil nurtures this promise and will help it bloom.", "You have shared a tale of nurturing, and in doing so, have tended to the roots of the world tree."],
            'ᛖ': ["Your story of teamwork shows the power of the herd. It is a reminder that no soul journeys alone.", "Trust is the bond that holds the worlds together. Your tale strengthens that bond."],
            'ᛗ': ["In sharing a story of the self, you have shared a story of all humanity. It is a profound reflection.", "Your tale is a mirror in which others will see themselves. This is the great power of the chronicle."],
            'ᛚ': ["Your story flows like water, finding its own path to the great sea of shared consciousness.", "Intuition is the whisper of the veil. Thank you for amplifying its voice with your tale."],
            'ᛜ': ["A story of inner work and potential is a sacred thing. The seed you have described will be protected here.", "You have shared a tale of home, and in doing so, have made this place more of a home for all."],
            'ᛟ': ["Your tale of inheritance honors all who came before. The ancestors listen and are pleased.", "By sharing a piece of your ancestry, you have enriched the lineage of all who seek wisdom here."],
            'ᛞ': ["You have chronicled your night, and in doing so, have helped manifest the dawn. The veil recognizes your breakthrough.", "A new day is not given, but made. Your story is an act of creation, and it is beautiful."]
        };
        
        const mapLore = {
            sun: {
                title: "Pyramid of the Sun",
                text: "The largest of the valley's structures. Its orientation to the cosmic north is more precise than that of the Great Pyramid of Giza. Energy scans have detected an unusual electromagnetic beam emanating from its peak, focused and continuous."
            },
            moon: {
                title: "Pyramid of the Moon",
                text: "A terraced structure built from sandstone blocks and clay. Below it lies a network of chambers and a small blue lake, untouched for millennia. The water here is said to have unique, life-affirming properties."
            },
            dragon: {
                title: "Pyramid of the Dragon",
                text: "This pyramid is believed to regulate the flow of energy throughout the valley. Its thermal inertia properties are remarkable, maintaining a stable internal temperature regardless of the outside weather, suggesting a complex internal design."
            },
            tunnels: {
                title: "Ravne Tunnel Labyrinth",
                text: "A vast, prehistoric network of tunnels running for kilometers beneath the valley. Within these tunnels, the air has an unusually high concentration of negative ions, creating an atmosphere of healing and tranquility. Carved megaliths and runic symbols are found throughout, their purpose still a mystery."
            }
        };

        let particlesArray = [];
        let mouse = { x: null, y: null, radius: 100 };
        let particleAnimationId;

        function calculateMoonPhase(date = new Date()) {
            const LUNAR_MONTH = 29.530588853;
            const getJulianDate = (d) => (d.getTime() / 86400000) - (d.getTimezoneOffset() / 1440) + 2440587.5;
            const knownNewMoon = getJulianDate(new Date(Date.UTC(2000, 0, 6, 18, 14, 0)));
            const julianDate = getJulianDate(date);
            const age = (julianDate - knownNewMoon) % LUNAR_MONTH;
            return age / LUNAR_MONTH;
        }

        function updateMoonVisual(phase) {
            const celestialBody = document.querySelector('.celestial-body');
            if (!celestialBody) return;
            
            let translateX;
            if (phase <= 0.5) {
                translateX = -phase * 200;
            } else {
                translateX = (1 - phase) * 200;
            }
            celestialBody.style.setProperty('--moon-phase-x', `${translateX}%`);
        }

        const beamCooldowns = { sun: 0, moon: 0, dragon: 0, night: 0 };
        const COOLDOWN_PERIOD = 5000; 

        function fireRunicBeam(pyramidName) {
            const now = Date.now();
            if (now < beamCooldowns[pyramidName]) return;
            
            const moonEl = document.getElementById('menuButton');
            const pyramidEl = document.querySelector(`.pyramid[data-pyramid="${pyramidName}"]`);
            const beamEl = document.getElementById(`beam-from-moon-${pyramidName}`);

            if (!moonEl || !pyramidEl || !beamEl) return;

            const moonRect = moonEl.getBoundingClientRect();
            const pyramidRect = pyramidEl.getBoundingClientRect();

            const beamStartX = moonRect.left + moonRect.width / 2;
            const beamStartY = moonRect.bottom;
            const beamEndY = pyramidRect.top;
            const height = beamEndY - beamStartY;

            if (height <= 0) return;

            beamEl.style.top = `${beamStartY}px`;
            beamEl.style.left = `${beamStartX - beamEl.offsetWidth / 2}px`;
            beamEl.style.height = `${height}px`;

            const runeCount = Math.floor(height / 18);
            let runesHTML = '';
            for (let i = 0; i < runeCount; i++) {
                const rune = elderFuthark[Math.floor(Math.random() * elderFuthark.length)];
                runesHTML += `<span style="animation-delay: ${i * 0.05}s">${rune.char}</span>`;
            }
            beamEl.innerHTML = runesHTML;
            beamEl.style.opacity = '1';

            beamCooldowns[pyramidName] = now + COOLDOWN_PERIOD;

            setTimeout(() => {
                beamEl.style.opacity = '0';
            }, 2500);
        }

        function checkMoonPyramidAlignment() {
            const moonEl = document.getElementById('menuButton');
            if (!moonEl) return;
            const moonRect = moonEl.getBoundingClientRect();
            const moonCenterX = moonRect.left + moonRect.width / 2;

            ['sun', 'moon', 'dragon', 'night'].forEach(name => {
                const pyramidEl = document.querySelector(`.pyramid[data-pyramid="${name}"]`);
                if(pyramidEl) {
                    const pyramidRect = pyramidEl.getBoundingClientRect();
                    const pyramidCenterX = pyramidRect.left + pyramidRect.width / 2;
                    if (Math.abs(moonCenterX - pyramidCenterX) < 20) { 
                        fireRunicBeam(name);
                    }
                }
            });
        }
        
        function alignmentLoop() {
            checkMoonPyramidAlignment();
            alignmentAnimationId = requestAnimationFrame(alignmentLoop);
        }

        function startAlignmentCheck() {
            if (!alignmentAnimationId) {
                alignmentLoop();
            }
        }
        function stopAlignmentCheck() {
            if (alignmentAnimationId) {
                cancelAnimationFrame(alignmentAnimationId);
                alignmentAnimationId = null;
            }
        }

        function handleResize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            initParticles();
        }

        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 2 + 0.5;
                this.baseX = this.x;
                this.baseY = this.y;
                this.density = (Math.random() * 30) + 1;
                this.opacity = Math.random() * 0.4 + 0.3;
                this.twinkleSpeed = Math.random() * 0.05;
            }
            draw() {
                const currentOpacity = this.opacity + Math.sin(Date.now() * this.twinkleSpeed) * (this.opacity * 0.4);
                ctx.fillStyle = `rgba(255, 215, 0, ${currentOpacity})`;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.closePath();
                ctx.fill();
            }
            update() {
                let dx = mouse.x - this.x;
                let dy = mouse.y - this.y;
                let distance = Math.sqrt(dx * dx + dy * dy);
                if (distance < mouse.radius) {
                    let forceDirectionX = dx / distance;
                    let forceDirectionY = dy / distance;
                    let maxDistance = mouse.radius;
                    let force = (maxDistance - distance) / maxDistance;
                    let directionX = (forceDirectionX * force * this.density);
                    let directionY = (forceDirectionY * force * this.density);
                    this.x -= directionX;
                    this.y -= directionY;
                } else {
                    if (this.x !== this.baseX) {
                        let dx = this.x - this.baseX;
                        this.x -= dx / 10;
                    }
                    if (this.y !== this.baseY) {
                        let dy = this.y - this.baseY;
                        this.y -= dy / 10;
                    }
                }
            }
        }

        function initParticles() {
            particlesArray = [];
            let numberOfParticles = (canvas.height * canvas.width) / 9000;
            for (let i = 0; i < numberOfParticles; i++) {
                particlesArray.push(new Particle());
            }
        }

        function animateParticles() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i < particlesArray.length; i++) {
                particlesArray[i].draw();
                particlesArray[i].update();
            }
            particleAnimationId = requestAnimationFrame(animateParticles);
        }

        function stopParticleAnimation() {
            if (particleAnimationId) {
                cancelAnimationFrame(particleAnimationId);
                particleAnimationId = null;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
            }
        }

        function startParticleAnimation() {
            if (!particleAnimationId) {
                handleResize();
                animateParticles();
            }
        }
        
        window.addEventListener('resize', () => {
             if (particleAnimationId) {
                handleResize();
            }
        });

        window.addEventListener('mousemove', (event) => {
            mouse.x = event.clientX;
            mouse.y = event.clientY;
        });
        
        function buildRuneAlphabet() {
            if (!runeAlphabetGrid) return;
            runeAlphabetGrid.innerHTML = '';
            elderFuthark.forEach(rune => {
                const item = document.createElement('div');
                item.className = 'rune-alphabet-item';
                item.innerHTML = `<div class="rune-alphabet-char">${rune.char}</div><div class="rune-alphabet-name">${rune.name}</div>`;
                runeAlphabetGrid.appendChild(item);
            });
        }
        buildRuneAlphabet();

        function speak(text) {
            if (!('speechSynthesis' in window)) return;
            speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.rate = 0.8;
            utterance.pitch = 0.9;
            speechSynthesis.speak(utterance);
        }

        toggleMeditationVoiceButton.addEventListener('click', () => {
            isMeditationTTSActive = !isMeditationTTSActive;
            toggleMeditationVoiceButton.textContent = isMeditationTTSActive ? "Disable Meditation Voice" : "Enable Meditation Voice";
            toggleMeditationVoiceButton.classList.toggle('active', isMeditationTTSActive);
            if (isMeditationTTSActive) speak(meditationStatus.textContent);
            else speechSynthesis.cancel();
        });

        toggleRuneVoiceButton.addEventListener('click', () => {
            isRuneTTSActive = !isRuneTTSActive;
            toggleRuneVoiceButton.textContent = isRuneTTSActive ? "Disable Reading Voice" : "Enable Reading Voice";
            toggleRuneVoiceButton.classList.toggle('active', isRuneTTSActive);
            if (isRuneTTSActive && runeInterpretation.textContent) speak(runeInterpretation.textContent);
            else speechSynthesis.cancel();
        });

        function getAncientCounsel() {
            if (isGenerating) return;
            isGenerating = true;
            runicOutput.textContent = '';
            englishOutput.textContent = '';
            englishOutput.classList.remove('visible');
            toggleTranslationButton.style.display = 'none';
            whisperBox.classList.add('loading');
            homePageDonationPrompt.style.display = 'none';
            
            setTimeout(() => {
                const wisdom = ancientWisdoms[Math.floor(Math.random() * ancientWisdoms.length)];
                runicOutput.textContent = wisdom.runic;
                englishOutput.textContent = wisdom.english;
                whisperBox.classList.remove('loading');
                toggleTranslationButton.style.display = 'inline-block';
                isGenerating = false;
                homePageDonationPrompt.innerHTML = `<p>If this whisper resonated, <a href="#" data-page="donate" class="text-yellow-400 hover:underline page-link">consider an offering</a> to keep the echoes alive.</p>`;
                homePageDonationPrompt.style.display = 'block';
            }, 1500);
        }

        function getRuneReading() {
            const question = runeQuestionInput.value.trim();
            if (!question) {
                runeInterpretation.textContent = "You must ask a question to receive a reading.";
                return;
            }
            if (isGenerating) return;
            isGenerating = true;
            runeDisplay.innerHTML = '';
            runeInterpretation.textContent = 'The runes are being cast...';
            toggleRuneVoiceButton.classList.add('hidden');
            postReadingMessage.style.display = 'none';
            
            setTimeout(() => {
                const reading = runeReadings[Math.floor(Math.random() * runeReadings.length)];
                
                runeDisplay.innerHTML = ''; 
                const runes = reading.runes.split('');
                runes.forEach(runeChar => {
                    const runeSpan = document.createElement('span');
                    runeSpan.className = 'rune-link';
                    runeSpan.textContent = runeChar;
                    runeSpan.dataset.rune = runeChar;
                    runeDisplay.appendChild(runeSpan);
                });

                runeInterpretation.innerHTML = reading.interpretation + 
                  '<p class="mt-4 text-sm text-yellow-400/70 italic">Click a rune above to reveal its artifact.</p>';

                toggleRuneVoiceButton.classList.remove('hidden');
                postReadingMessage.style.display = 'block';
                if (isRuneTTSActive) speak(reading.interpretation);
                isGenerating = false;
            }, 2500);
        }

        function initializeStoryteller() {
            const randomRune = elderFuthark[Math.floor(Math.random() * elderFuthark.length)];
            storytellerRune.textContent = randomRune.char;
            storytellerMeaning.textContent = `${randomRune.name}: ${randomRune.meaning}`;
            currentStorytellerRune = randomRune;
            const stories = JSON.parse(localStorage.getItem('runic_stories') || '[]');
            displayStories(stories);
        }

        function submitStory() {
            const storyText = storytellerInput.value.trim();
            if (storyText.length < 10) {
                storytellerStatusMessage.textContent = "Your story is too brief. A keeper's tale must be told with more detail.";
                setTimeout(() => storytellerStatusMessage.textContent = "Tell your tale, keeper.", 5000);
                return;
            }

            submitStoryButton.disabled = true;
            storytellerStatusMessage.textContent = "Submitting your echo to the veil...";

            const stories = JSON.parse(localStorage.getItem('runic_stories') || '[]');
            const newStory = {
                rune: currentStorytellerRune.char,
                story: storyText,
                timestamp: new Date().toLocaleString()
            };
            stories.unshift(newStory);
            localStorage.setItem('runic_stories', JSON.stringify(stories));

            storytellerInput.classList.add('hidden');
            storytellerStatusMessage.textContent = ''; 

            const reflections = runeReflections[currentStorytellerRune.char] || ["Your story has been received and woven into the great tapestry."];
            const reflection = reflections[Math.floor(Math.random() * reflections.length)];

            storytellerSuccessMessage.textContent = reflection;
            storytellerSuccessMessage.classList.remove('hidden');

            storytellerDonationPrompt.innerHTML = `<p class="mt-4">Your story strengthens the veil. <a href="#" data-page="donate" class="text-yellow-400 hover:underline page-link">Become a Guardian of the Chronicle</a>.</p>`;
            storytellerDonationPrompt.style.display = 'block';

            setTimeout(() => {
                storytellerSuccessMessage.classList.add('hidden');
                storytellerDonationPrompt.style.display = 'none';
                storytellerInput.value = ''; 
                storytellerInput.classList.remove('hidden'); 
                storytellerStatusMessage.textContent = "Tell your tale, keeper.";
                submitStoryButton.disabled = false;
                displayStories(stories);
            }, 10000);
        }

        function displayStories(stories) {
            storiesContainer.innerHTML = '';
            if (stories.length === 0) {
                storiesContainer.innerHTML = `<p class="text-gray-500 text-center italic">Your personal chronicle is empty. Be the first to write!</p>`;
                return;
            }
            stories.forEach(story => {
                const storyCard = document.createElement('div');
                storyCard.className = 'story-card';
                storyCard.innerHTML = `
                    <div class="story-rune">${story.rune}</div>
                    <p class="story-text">${story.story}</p>
                    <div class="story-meta">
                        <span class="story-author">Your Echo</span>
                        <span class="story-timestamp">${story.timestamp}</span>
                    </div>`;
                storiesContainer.appendChild(storyCard);
            });
        }
        
        initialEntryOverlay.addEventListener('click', () => {
            initialEntryOverlay.classList.add('hidden');
            mainContentArea.classList.add('active');

            const menuHint = document.getElementById('menuHint');
            if (menuHint) {
                setTimeout(() => {
                    menuHint.style.opacity = '0';
                }, 4000);
            }
            updateCounter();
        }, { once: true });
        
        document.getElementById('pyramidGroup').addEventListener('click', (e) => {
            const pyramidButton = e.target.closest('.pyramid');
            if (pyramidButton) {
                const beam = pyramidButton.querySelector('.beam');
                const shape = pyramidButton.querySelector('.pyramid-shape');

                if (shape) {
                    shape.classList.add('charging');
                    setTimeout(() => {
                        shape.classList.remove('charging');
                    }, 1000);
                }

                if (beam) {
                    setTimeout(() => {
                        beam.style.opacity = '1';
                        setTimeout(() => beam.style.opacity = '0', 2000);
                    }, 200);
                }
                getAncientCounsel();
            }
        });

        toggleTranslationButton.addEventListener('click', () => englishOutput.classList.toggle('visible'));
        drawRunesButton.addEventListener('click', getRuneReading);
        submitStoryButton.addEventListener('click', submitStory);
        menuButton.addEventListener('click', () => overlayMenu.classList.add('active'));
        closeMenuButton.addEventListener('click', () => overlayMenu.classList.remove('active'));

        function showPage(pageId, force = false) {
            if (pageId === 'sanctumPage' && !force) {
                if (localStorage.getItem('hasDonated') !== 'true') {
                    sanctumContent.classList.add('hidden');
                    sanctumAccessDenied.classList.remove('hidden');
                } else {
                    sanctumContent.classList.remove('hidden');
                    sanctumAccessDenied.classList.add('hidden');
                }
            }

            window.scrollTo(0, 0);
            speechSynthesis.cancel();
            allPages.forEach(page => page.classList.remove('active'));
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
                if (pageId === 'storytellerPage') initializeStoryteller();
                if (pageId === 'guardiansPage') generateKeepersGrid();
            }
        }

        function handlePageNavigation(e) {
            e.preventDefault();
            const pageId = e.currentTarget.dataset.page + 'Page';
            showPage(pageId);
            if(overlayMenu.classList.contains('active')) {
                overlayMenu.classList.remove('active');
            }
        }

        navLinks.forEach(link => link.addEventListener('click', handlePageNavigation));
        document.body.addEventListener('click', function(event) {
            if (event.target.matches('.page-link, .page-link *')) {
                const targetLink = event.target.closest('.page-link');
                handlePageNavigation({ currentTarget: targetLink, preventDefault: () => {} });
            }
        });
        
        contactForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const message = keeperMessage.value.trim();
            if (!message) {
                messageFeedback.textContent = 'You must scribe a question for the keeper to answer.';
                setTimeout(() => { messageFeedback.textContent = ''; }, 4000);
                return;
            }
            const answer = keeperAnswers[Math.floor(Math.random() * keeperAnswers.length)];
            messageFeedback.textContent = answer;
            setTimeout(() => {
                contactForm.reset();
                messageFeedback.textContent = '';
            }, 8000); 
        });

        const meditationScripts = {
            'ᛗ': "Focus on the self. Feel the connection to all of humanity.", 'ᛟ': "Think of your heritage, your ancestors. Feel their strength.", 'ᛞ': "Embrace the dawn of a new understanding. A breakthrough is near.", '': "Open yourself to illumination and creativity. Knowledge flows to you.", 'ᛋ': "Feel wholeness and success. The sun's energy empowers you.", 'ᛁ': "Find stillness within. Be calm and centered, like ice.", 'ᚹ': "Allow joy and harmony to fill your spirit.", 'ᛚ': "Go with the flow. Trust your intuition, like water."
        };
        const meditationRunes = Object.keys(meditationScripts);
        let runeIndex = 0;

        setInterval(() => {
            if(meditationCircle && meditationRune && meditationStatus) {
                meditationCircle.classList.toggle('pulsing');
                runeIndex = (runeIndex + 1) % meditationRunes.length;
                const currentRune = meditationRunes[runeIndex];
                meditationRune.textContent = currentRune;
                const script = meditationScripts[currentRune];
                meditationStatus.textContent = script;
                if (isMeditationTTSActive) speak(script);
            }
        }, 8000);

        function updateCounter() {
            let count = parseInt(localStorage.getItem('visitCount') || '0') + 1;
            localStorage.setItem('visitCount', count);
            visitCounterElement.textContent = count;
        }
        
        let initialCount = localStorage.getItem('visitCount') || '0';
        visitCounterElement.textContent = initialCount;

        function updateDonationProgress() {
            const goal = 1200;
            const currentAmount = parseInt(localStorage.getItem('donationAmount')) || 450;
            const percentage = Math.min((currentAmount / goal) * 100, 100);
            donationProgress.style.width = `${percentage}%`;
            currentDonations.textContent = currentAmount;
        }
        updateDonationProgress();

        function updateKeepersCount() {
            const date = new Date();
            const keeperCount = 17 + (date.getDate() % 10);
            if (keepersCount) keepersCount.textContent = keeperCount;
            if (frontPageKeepersCount) frontPageKeepersCount.textContent = keeperCount;
            return keeperCount;
        }

        function generateKeepersGrid() {
            if (!keepersGrid) return;
            keepersGrid.innerHTML = '';
            const keeperCount = updateKeepersCount();
            for (let i = 0; i < keeperCount; i++) {
                const rune = elderFuthark[Math.floor(Math.random() * elderFuthark.length)];
                const runeEl = document.createElement('span');
                runeEl.className = 'keeper-rune';
                runeEl.textContent = rune.char;
                runeEl.style.animationDelay = `${i * 0.05}s`;
                keepersGrid.appendChild(runeEl);
            }
        }

        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('from') === 'stripe') {
            localStorage.setItem('hasDonated', 'true');
            const url = new URL(window.location);
            url.searchParams.delete('from');
            window.history.replaceState({}, document.title, url.pathname + '#sanctumPage');
            showPage('sanctumPage', true);
        } else {
             const hash = window.location.hash.substring(1);
             if (hash) showPage(hash, false);
        }

        mapContainer.addEventListener('click', (e) => {
            if (e.target.classList.contains('hotspot')) {
                const point = e.target.dataset.point;
                const data = mapLore[point];
                if (data) {
                    loreTitle.textContent = data.title;
                    loreText.textContent = data.text;
                    loreImage.src = '';
                    loreImage.classList.add('hidden');
                    loreModal.classList.add('visible');
                }
            }
        });

        runeDisplay.addEventListener('click', (e) => {
            if (e.target.classList.contains('rune-link')) {
                const runeChar = e.target.dataset.rune;
                const artifact = runeArtifacts[runeChar];

                if (artifact) {
                    loreTitle.textContent = artifact.title;
                    loreText.textContent = artifact.description;
                    loreImage.src = artifact.image;
                    loreImage.classList.remove('hidden');
                    
                    loreModal.classList.add('visible');
                }
            }
        });

        const closeLoreModal = () => loreModal.classList.remove('visible');
        loreCloseButton.addEventListener('click', closeLoreModal);
        loreModal.addEventListener('click', (e) => {
            if (e.target === loreModal) {
                closeLoreModal();
            }
        });
        
        const shareTwitter = document.getElementById('share-twitter');
        const shareFacebook = document.getElementById('share-facebook');
        const copyLink = document.getElementById('copy-link');
        const copyLinkFeedback = document.getElementById('copy-link-feedback');

        const shareUrl = 'https://bosnianpyramids.netlify.app/';
        const shareText = 'I\'ve been listening to the ancient echoes from the Bosnian Pyramids. What will they whisper to you?';

        shareTwitter.addEventListener('click', (e) => {
            e.preventDefault();
            const twitterUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(shareUrl)}&text=${encodeURIComponent(shareText)}`;
            window.open(twitterUrl, '_blank');
        });

        shareFacebook.addEventListener('click', (e) => {
            e.preventDefault();
            const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}`;
            window.open(facebookUrl, '_blank');
        });

        copyLink.addEventListener('click', (e) => {
            e.preventDefault();
            navigator.clipboard.writeText(shareUrl).then(() => {
                copyLinkFeedback.style.opacity = '1';
                setTimeout(() => {
                    copyLinkFeedback.style.opacity = '0';
                }, 2000);
            });
        });

        // --- INITIALIZE ---
        startParticleAnimation();
        startAlignmentCheck();
        updateMoonVisual(calculateMoonPhase());
        updateKeepersCount();

    });
</script>
</body>
</html>
